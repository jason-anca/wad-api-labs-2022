{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Jason/Documents/GitHub/wad-api-labs-2022/movies-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Jason/Documents/GitHub/wad-api-labs-2022/movies-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"C:/Users/Jason/Documents/GitHub/wad-api-labs-2022/movies-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\Jason\\\\Documents\\\\GitHub\\\\wad-api-labs-2022\\\\movies-app\\\\src\\\\contexts\\\\authContext.js\",\n    _this = this;\n\nimport React, { useState, createContext } from \"react\";\nimport { login, signup } from \"./api/movie-api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var AuthContext = /*#__PURE__*/createContext(null);\n\nvar AuthContextProvider = function AuthContextProvider(props) {\n  var existingToken = localStorage.getItem(\"token\");\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState(existingToken),\n      _useState4 = _slicedToArray(_useState3, 2),\n      authToken = _useState4[0],\n      setAuthToken = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      userName = _useState6[0],\n      setUserName = _useState6[1]; //Function to put JWT token in local storage.\n\n\n  var setToken = function setToken(data) {\n    localStorage.setItem(\"token\", data);\n    setAuthToken(data);\n  };\n\n  var authenticate = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(username, password) {\n      var result;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return login(username, password);\n\n            case 2:\n              result = _context.sent;\n\n              if (result.token) {\n                setToken(result.token);\n                setIsAuthenticated(true);\n                setUserName(username);\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function authenticate(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var register = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(username, password) {\n      var result;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return signup(username, password);\n\n            case 2:\n              result = _context2.sent;\n              console.log(result.code);\n              return _context2.abrupt(\"return\", result.code == 201 ? true : false);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function register(_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var signout = function signout() {\n    setTimeout(function () {\n      return setIsAuthenticated(false);\n    }, 100);\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      isAuthenticated: isAuthenticated,\n      authenticate: authenticate,\n      register: register,\n      signout: signout,\n      userName: userName\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, _this);\n};\n\nexport default AuthContextProvider;","map":{"version":3,"names":["React","useState","createContext","login","signup","AuthContext","AuthContextProvider","props","existingToken","localStorage","getItem","isAuthenticated","setIsAuthenticated","authToken","setAuthToken","userName","setUserName","setToken","data","setItem","authenticate","username","password","result","token","register","console","log","code","signout","setTimeout","children"],"sources":["C:/Users/Jason/Documents/GitHub/wad-api-labs-2022/movies-app/src/contexts/authContext.js"],"sourcesContent":["import React, { useState, createContext } from \"react\";\r\nimport { login, signup } from \"./api/movie-api\";\r\n\r\nexport const AuthContext = createContext(null);\r\n\r\nconst AuthContextProvider = (props) => {\r\n  const existingToken = localStorage.getItem(\"token\");\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [authToken, setAuthToken] = useState(existingToken);\r\n  const [userName, setUserName] = useState(\"\");\r\n\r\n  //Function to put JWT token in local storage.\r\n  const setToken = (data) => {\r\n    localStorage.setItem(\"token\", data);\r\n    setAuthToken(data);\r\n  }\r\n\r\n  const authenticate = async (username, password) => {\r\n    const result = await login(username, password);\r\n    if (result.token) {\r\n      setToken(result.token)\r\n      setIsAuthenticated(true);\r\n      setUserName(username);\r\n    }\r\n  };\r\n\r\n  const register = async (username, password) => {\r\n    const result = await signup(username, password);\r\n    console.log(result.code);\r\n    return (result.code == 201) ? true : false;\r\n  };\r\n\r\n  const signout = () => {\r\n    setTimeout(() => setIsAuthenticated(false), 100);\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        isAuthenticated,\r\n        authenticate,\r\n        register,\r\n        signout,\r\n        userName\r\n      }}\r\n    >\r\n      {props.children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthContextProvider;"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,aAA1B,QAA+C,OAA/C;AACA,SAASC,KAAT,EAAgBC,MAAhB,QAA8B,iBAA9B;;AAEA,OAAO,IAAMC,WAAW,gBAAGH,aAAa,CAAC,IAAD,CAAjC;;AAEP,IAAMI,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,KAAD,EAAW;EACrC,IAAMC,aAAa,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAtB;;EACA,gBAA8CT,QAAQ,CAAC,KAAD,CAAtD;EAAA;EAAA,IAAOU,eAAP;EAAA,IAAwBC,kBAAxB;;EACA,iBAAkCX,QAAQ,CAACO,aAAD,CAA1C;EAAA;EAAA,IAAOK,SAAP;EAAA,IAAkBC,YAAlB;;EACA,iBAAgCb,QAAQ,CAAC,EAAD,CAAxC;EAAA;EAAA,IAAOc,QAAP;EAAA,IAAiBC,WAAjB,iBAJqC,CAMrC;;;EACA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,IAAD,EAAU;IACzBT,YAAY,CAACU,OAAb,CAAqB,OAArB,EAA8BD,IAA9B;IACAJ,YAAY,CAACI,IAAD,CAAZ;EACD,CAHD;;EAKA,IAAME,YAAY;IAAA,sEAAG,iBAAOC,QAAP,EAAiBC,QAAjB;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACEnB,KAAK,CAACkB,QAAD,EAAWC,QAAX,CADP;;YAAA;cACbC,MADa;;cAEnB,IAAIA,MAAM,CAACC,KAAX,EAAkB;gBAChBP,QAAQ,CAACM,MAAM,CAACC,KAAR,CAAR;gBACAZ,kBAAkB,CAAC,IAAD,CAAlB;gBACAI,WAAW,CAACK,QAAD,CAAX;cACD;;YANkB;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAH;;IAAA,gBAAZD,YAAY;MAAA;IAAA;EAAA,GAAlB;;EASA,IAAMK,QAAQ;IAAA,uEAAG,kBAAOJ,QAAP,EAAiBC,QAAjB;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACMlB,MAAM,CAACiB,QAAD,EAAWC,QAAX,CADZ;;YAAA;cACTC,MADS;cAEfG,OAAO,CAACC,GAAR,CAAYJ,MAAM,CAACK,IAAnB;cAFe,kCAGPL,MAAM,CAACK,IAAP,IAAe,GAAhB,GAAuB,IAAvB,GAA8B,KAHtB;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAAH;;IAAA,gBAARH,QAAQ;MAAA;IAAA;EAAA,GAAd;;EAMA,IAAMI,OAAO,GAAG,SAAVA,OAAU,GAAM;IACpBC,UAAU,CAAC;MAAA,OAAMlB,kBAAkB,CAAC,KAAD,CAAxB;IAAA,CAAD,EAAkC,GAAlC,CAAV;EACD,CAFD;;EAIA,oBACE,QAAC,WAAD,CAAa,QAAb;IACE,KAAK,EAAE;MACLD,eAAe,EAAfA,eADK;MAELS,YAAY,EAAZA,YAFK;MAGLK,QAAQ,EAARA,QAHK;MAILI,OAAO,EAAPA,OAJK;MAKLd,QAAQ,EAARA;IALK,CADT;IAAA,UASGR,KAAK,CAACwB;EATT;IAAA;IAAA;IAAA;EAAA,SADF;AAaD,CA5CD;;AA8CA,eAAezB,mBAAf"},"metadata":{},"sourceType":"module"}